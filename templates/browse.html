<!doctype html>
<title>Browse TEMPLAR</title>
<style>
body { font-family: sans-serif; background:#111; color:#eee; padding:20px }
.card { background:#222; padding:15px; border-radius:8px; max-width:800px }
a { color:#7fc7ff; text-decoration:none; margin-right:8px }
ul { list-style:none; padding-left:0 }
li { padding:4px 0 }
.folder::before { content:"ğŸ“ "; }
.file::before { content:"ğŸ“„ "; }
.back::before { content:"â¬…ï¸ "; }
form.inline { display:inline }
button.small { background:#333; color:#eee; border:none; padding:2px 6px; cursor:pointer; }
button.small:hover { background:#444 }
</style>

<div class="card">
  <h2>Browsing: /{{ relpath }}</h2>

  <h3>Create Folder</h3>
  <form method="POST" action="/create_folder">
    <input type="hidden" name="parent" value="{{ relpath }}">
    <input type="text" name="foldername" required>
    <button>Create</button>
  </form>

  <hr>

  <ul>
    {% if parent %}
      <li class="back"><a href="{{ parent }}">..</a></li>
    {% endif %}

    {% for d in dirs %}
      <li class="folder">
        {{ d.name }}
        <a href="/browse/{{ d }}">Open</a>
        <a href="/zip/{{ d }}">ğŸ“¦</a>

        <form class="inline" method="POST" action="/rename">
          <input type="hidden" name="path" value="{{ d }}">
          <input name="newname" placeholder="Rename">
          <button class="small">âœï¸</button>
        </form>

        <form class="inline" method="POST" action="/delete" onsubmit="return confirm('Delete folder?')">
          <input type="hidden" name="path" value="{{ d }}">
          <button class="small">ğŸ—‘ï¸</button>
        </form>

        <form class="inline" method="POST" action="/move">
          <input type="hidden" name="path" value="{{ d }}">
          <select name="dest">
            {% for f in all_subfolders %}
              <option value="{{ f }}">{{ f }}</option>
            {% endfor %}
          </select>
          <button class="small">â¡ï¸</button>
        </form>
      </li>
    {% endfor %}

    {% for f in files %}
      <li class="file">
        {{ f.name }}
        <a href="/download/{{ f }}">â¬‡ï¸</a>

        <form class="inline" method="POST" action="/rename">
          <input type="hidden" name="path" value="{{ f }}">
          <input name="newname" placeholder="Rename">
          <button class="small">âœï¸</button>
        </form>

        <form class="inline" method="POST" action="/delete" onsubmit="return confirm('Delete file?')">
          <input type="hidden" name="path" value="{{ f }}">
          <button class="small">ğŸ—‘ï¸</button>
        </form>

        <form class="inline" method="POST" action="/move">
          <input type="hidden" name="path" value="{{ f }}">
          <select name="dest">
            {% for folder in all_subfolders %}
              <option value="{{ folder }}">{{ folder }}</option>
            {% endfor %}
          </select>
          <button class="small">â¡ï¸</button>
        </form>
      </li>
    {% endfor %}
  </ul>

  <hr>
  <a href="/">â¬…ï¸ Back to Dashboard</a>
</div>
